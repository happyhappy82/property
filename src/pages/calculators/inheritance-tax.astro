---
import CalcLayout from '../../layouts/CalcLayout.astro'
---

<CalcLayout
  title="부동산 상속세 계산기 - 부동산 트렌드 리뷰"
  description="상속세를 간편하게 계산하세요. 배우자 공제, 일괄공제, 금융재산 공제 등 주요 공제 항목을 반영합니다."
>
    <div class="mb-6">
      <a href="/calculators" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">&larr; 계산기 목록</a>
    </div>
    <h1 class="text-2xl font-bold mb-2 dark:text-white">부동산 상속세 계산기</h1>
    <p class="text-gray-600 dark:text-gray-400 mb-6 text-sm">부동산 상속세 계산기를 이용하면 상속 재산 규모에 따른 예상 상속세를 미리 확인할 수 있습니다. 배우자 공제, 일괄공제, 금융재산 공제 등 주요 공제 항목을 반영하여 부동산 상속세를 자동으로 산출합니다. 상속 설계를 준비 중이라면 이 계산기로 부동산 상속세 부담을 사전에 점검해 보세요.</p>

    <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 mb-6">
      <form id="calcForm" class="space-y-4">
        <div>
          <label for="totalAsset" class="block text-sm font-medium mb-1 dark:text-gray-200">상속재산 총액</label>
          <div class="relative">
            <input type="text" id="totalAsset" placeholder="1,000,000,000" required
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div>
          <label for="debts" class="block text-sm font-medium mb-1 dark:text-gray-200">채무</label>
          <div class="relative">
            <input type="text" id="debts" placeholder="0"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div>
          <label for="funeralCost" class="block text-sm font-medium mb-1 dark:text-gray-200">장례비용 <span class="text-xs font-normal text-gray-500">(최대 1,500만원)</span></label>
          <div class="relative">
            <input type="text" id="funeralCost" placeholder="0"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div>
          <label for="hasSpouse" class="block text-sm font-medium mb-1 dark:text-gray-200">배우자 유무</label>
          <select id="hasSpouse" class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            <option value="no">없음</option>
            <option value="yes">있음</option>
          </select>
        </div>

        <div id="spouseShareDiv" style="display: none;">
          <label for="spouseSharePct" class="block text-sm font-medium mb-1 dark:text-gray-200">배우자 법정상속분 <span class="text-xs font-normal text-gray-500">(통상 50%)</span></label>
          <div class="relative">
            <input type="number" id="spouseSharePct" placeholder="50" min="0" max="100"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">%</span>
          </div>
        </div>

        <div>
          <label for="financialAssets" class="block text-sm font-medium mb-1 dark:text-gray-200">금융재산</label>
          <div class="relative">
            <input type="text" id="financialAssets" placeholder="0"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div class="flex items-center gap-2">
          <input type="checkbox" id="coResidence" class="rounded" />
          <label for="coResidence" class="text-sm dark:text-gray-200 cursor-pointer">10년 이상 동거한 주택 상속</label>
        </div>

        <div id="coResidenceValueDiv" style="display: none;">
          <label for="coResidenceValue" class="block text-sm font-medium mb-1 dark:text-gray-200">동거주택 가액 <span class="text-xs font-normal text-gray-500">(최대 6억원 공제)</span></label>
          <div class="relative">
            <input type="text" id="coResidenceValue" placeholder="0"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <button type="submit" id="calcBtn"
          class="w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors">
          계산하기
        </button>
      </form>
    </div>

    <div id="results" class="hidden space-y-4">
      <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-800 p-4">
        <h2 class="text-sm font-medium text-blue-800 dark:text-blue-300 mb-3">상속세 합계</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">총 납부세액</span><span class="font-bold text-blue-700 dark:text-blue-300" id="totalTax">0원</span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">실효세율</span><span class="font-medium dark:text-gray-200" id="effectiveRate">0%</span></div>
        </div>
      </div>

      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4">
        <h2 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">공제 내역</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">상속재산 총액</span><span class="dark:text-gray-200" id="totalAssetDisplay">0원</span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">(-)채무·장례비</span><span class="text-red-600 dark:text-red-400" id="debtsFuneralDisplay">0원</span></div>
          <div class="flex justify-between border-t border-gray-200 dark:border-gray-600 pt-2 mt-2"><span class="text-sm font-medium dark:text-gray-200">상속세 과세가액</span><span class="font-bold dark:text-gray-200" id="taxableInheritance">0원</span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">(-)일괄공제</span><span class="text-green-600 dark:text-green-400" id="lumpSumDeduction">0원</span></div>
          <div id="spouseDeductionDiv" class="flex justify-between" style="display: none;"><span class="text-sm dark:text-gray-300">(-)배우자 공제</span><span class="text-green-600 dark:text-green-400" id="spouseDeduction">0원</span></div>
          <div id="financialDeductionDiv" class="flex justify-between" style="display: none;"><span class="text-sm dark:text-gray-300">(-)금융재산 공제</span><span class="text-green-600 dark:text-green-400" id="financialDeduction">0원</span></div>
          <div id="coResidenceDeductionDiv" class="flex justify-between" style="display: none;"><span class="text-sm dark:text-gray-300">(-)동거주택 공제</span><span class="text-green-600 dark:text-green-400" id="coResidenceDeduction">0원</span></div>
          <div class="flex justify-between border-t border-gray-200 dark:border-gray-600 pt-2 mt-2"><span class="text-sm font-medium dark:text-gray-200">과세표준</span><span class="font-bold dark:text-gray-200" id="taxBase">0원</span></div>
        </div>
      </div>

      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4">
        <h2 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">세액 계산</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">적용세율</span><span class="dark:text-gray-200" id="taxRateDisplay">0%</span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">산출세액</span><span class="dark:text-gray-200" id="calculatedTax">0원</span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">(-)신고세액공제 3%</span><span class="text-green-600 dark:text-green-400" id="filingCredit">0원</span></div>
          <div class="flex justify-between border-t border-gray-200 dark:border-gray-600 pt-2 mt-2"><span class="text-sm font-medium dark:text-gray-200">납부할 세액</span><span class="font-bold text-blue-600 dark:text-blue-400" id="finalTax">0원</span></div>
        </div>
      </div>
    </div>

    <div class="mt-8 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700">
      <p class="text-xs text-gray-500 dark:text-gray-400">
        ※ 본 계산기는 참고용이며, 실제 세액은 개인의 상황에 따라 달라질 수 있습니다. 정확한 세액 산정을 위해서는 전문가와 상담하시기 바랍니다.
      </p>
    </div>

  <!-- SEO 콘텐츠 섹션 -->
  <article class="mt-12 prose prose-sm dark:prose-invert max-w-none">
    <section class="mb-10">
      <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">상속세란?</h2>
      <p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-3">상속세는 사망으로 인하여 피상속인(사망자)의 재산이 상속인에게 이전될 때 부과되는 세금입니다. 상속세 신고기한은 상속개시일(사망일)이 속하는 달의 말일부터 6개월 이내이며, 기한 내 신고 시 산출세액의 3%를 신고세액공제로 받을 수 있습니다.</p>
      <p class="text-gray-700 dark:text-gray-300 leading-relaxed">상속세 계산 시 기초공제(2억 원)와 인적공제를 합산하되, 일괄공제(5억 원)와 비교하여 큰 금액을 적용합니다. 대부분의 경우 일괄공제 5억 원이 유리합니다. 배우자가 있는 경우 배우자 상속공제를 추가로 적용받을 수 있으며, 최소 5억 원에서 최대 30억 원까지 공제됩니다.</p>
    </section>

    <section class="mb-10">
      <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">상속세 세율표</h2>
      <div class="overflow-x-auto">
        <table class="w-full text-sm border-collapse border border-gray-200 dark:border-gray-700">
          <thead>
            <tr class="bg-gray-100 dark:bg-gray-700">
              <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">과세표준</th>
              <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">세율</th>
              <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">누진공제</th>
            </tr>
          </thead>
          <tbody class="dark:text-gray-300">
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1억원 이하</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">10%</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">-</td>
            </tr>
            <tr class="bg-gray-50 dark:bg-gray-800/50">
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1억원 ~ 5억원</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">20%</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1,000만원</td>
            </tr>
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">5억원 ~ 10억원</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">30%</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">6,000만원</td>
            </tr>
            <tr class="bg-gray-50 dark:bg-gray-800/50">
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">10억원 ~ 30억원</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">40%</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1억 6,000만원</td>
            </tr>
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">30억원 초과</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">50%</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">4억 6,000만원</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="mt-4 overflow-x-auto">
        <table class="w-full text-sm border-collapse border border-gray-200 dark:border-gray-700">
          <thead>
            <tr class="bg-gray-100 dark:bg-gray-700">
              <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">주요 공제 항목</th>
              <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">공제 금액</th>
            </tr>
          </thead>
          <tbody class="dark:text-gray-300">
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">기초공제</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">2억원</td>
            </tr>
            <tr class="bg-gray-50 dark:bg-gray-800/50">
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">일괄공제</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">5억원 (기초공제+인적공제와 택1)</td>
            </tr>
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">배우자 상속공제</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">최소 5억원 ~ 최대 30억원</td>
            </tr>
            <tr class="bg-gray-50 dark:bg-gray-800/50">
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">금융재산 상속공제</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">최대 2억원</td>
            </tr>
            <tr>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">동거주택 상속공제</td>
              <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">최대 6억원</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="mb-10">
      <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">상속세 계산 예시</h2>
      <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
        <h3 class="text-base font-semibold dark:text-white mb-3">예시: 총 상속재산 10억 원 (배우자 있음)</h3>
        <div class="text-sm text-gray-700 dark:text-gray-300 space-y-1.5">
          <p>· 총 상속재산: 10억 원 (채무·장례비 없다고 가정)</p>
          <p>· 상속세 과세가액: 10억 원</p>
          <p>· 일괄공제: 5억 원</p>
          <p>· 배우자 상속공제: 5억 원 (법정상속분 50% 기준)</p>
          <p>· 과세표준: 10억 - 5억 - 5억 = 0원</p>
          <p class="font-semibold dark:text-white mt-3 pt-3 border-t border-gray-200 dark:border-gray-600">· 결과: <span class="text-blue-600 dark:text-blue-400">상속세 0원 (공제 합계가 과세가액 이상)</span></p>
        </div>
      </div>
      <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 border border-gray-200 dark:border-gray-700 mt-4">
        <h3 class="text-base font-semibold dark:text-white mb-3">예시: 총 상속재산 10억 원 (배우자 없음)</h3>
        <div class="text-sm text-gray-700 dark:text-gray-300 space-y-1.5">
          <p>· 총 상속재산: 10억 원</p>
          <p>· 일괄공제: 5억 원</p>
          <p>· 과세표준: 10억 - 5억 = 5억 원</p>
          <p>· 세율 적용: 5억 × 20% - 1,000만 = 9,000만 원</p>
          <p>· 신고세액공제 (3%): 9,000만 × 3% = 270만 원</p>
          <p class="font-semibold dark:text-white mt-3 pt-3 border-t border-gray-200 dark:border-gray-600">· 결과: <span class="text-blue-600 dark:text-blue-400">납부할 상속세 약 8,730만 원</span></p>
        </div>
      </div>
    </section>

    <section class="mb-10">
      <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">상속세 자주 묻는 질문</h2>
      <div class="space-y-4">
        <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg" open>
          <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
            <span>Q. 기초공제와 일괄공제의 차이는 무엇인가요?</span>
            <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </summary>
          <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">기초공제는 2억 원이며, 여기에 자녀공제(1인당 5,000만 원), 미성년자공제, 연로자공제, 장애인공제 등 인적공제를 합산합니다. 일괄공제는 이러한 개별 공제를 계산하지 않고 5억 원을 한 번에 공제하는 방식입니다. 기초공제+인적공제 합계와 일괄공제 5억 원 중 큰 금액을 선택할 수 있으며, 대부분의 경우 일괄공제 5억 원이 유리합니다.</div>
        </details>
        <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
          <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
            <span>Q. 배우자 상속공제는 얼마까지 받을 수 있나요?</span>
            <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </summary>
          <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">배우자 상속공제는 배우자의 법정상속분(실제 상속받은 금액) 범위 내에서 적용되며, 최소 5억 원에서 최대 30억 원까지 공제됩니다. 배우자가 실제 상속받은 금액이 없더라도 최소 5억 원은 공제됩니다. 배우자 공제는 일괄공제와 별도로 추가 적용되므로 절세 효과가 큽니다.</div>
        </details>
        <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
          <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
            <span>Q. 상속세 신고기한은 언제인가요?</span>
            <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </summary>
          <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">상속세는 상속개시일(사망일)이 속하는 달의 말일부터 6개월 이내에 신고·납부해야 합니다. 예를 들어 3월에 사망한 경우 9월 30일까지 신고해야 합니다. 피상속인 또는 상속인이 외국에 거주하는 경우에는 9개월로 연장됩니다. 기한 내 신고 시 산출세액의 3% 신고세액공제를 받을 수 있습니다.</div>
        </details>
        <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
          <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
            <span>Q. 상속 부동산은 어떻게 평가하나요?</span>
            <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </summary>
          <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">상속 부동산은 원칙적으로 시가(시장가격)로 평가합니다. 시가를 알 수 없는 경우 공동주택은 공시가격, 단독주택은 개별주택가격, 토지는 개별공시지가를 기준으로 평가합니다. 아파트의 경우 상속개시일 전후 6개월 이내의 매매사례가액이 있으면 이를 시가로 인정합니다. 감정평가를 받으면 시가로 인정되어 정확한 평가가 가능합니다.</div>
        </details>
      </div>
    </section>
  </article>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "기초공제와 일괄공제의 차이는 무엇인가요?",
        "acceptedAnswer": { "@type": "Answer", "text": "기초공제는 2억 원이며, 여기에 자녀공제(1인당 5,000만 원), 미성년자공제, 연로자공제, 장애인공제 등 인적공제를 합산합니다. 일괄공제는 이러한 개별 공제를 계산하지 않고 5억 원을 한 번에 공제하는 방식입니다. 기초공제+인적공제 합계와 일괄공제 5억 원 중 큰 금액을 선택할 수 있으며, 대부분의 경우 일괄공제 5억 원이 유리합니다." }
      },
      {
        "@type": "Question",
        "name": "배우자 상속공제는 얼마까지 받을 수 있나요?",
        "acceptedAnswer": { "@type": "Answer", "text": "배우자 상속공제는 배우자의 법정상속분(실제 상속받은 금액) 범위 내에서 적용되며, 최소 5억 원에서 최대 30억 원까지 공제됩니다. 배우자가 실제 상속받은 금액이 없더라도 최소 5억 원은 공제됩니다. 배우자 공제는 일괄공제와 별도로 추가 적용되므로 절세 효과가 큽니다." }
      },
      {
        "@type": "Question",
        "name": "상속세 신고기한은 언제인가요?",
        "acceptedAnswer": { "@type": "Answer", "text": "상속세는 상속개시일(사망일)이 속하는 달의 말일부터 6개월 이내에 신고·납부해야 합니다. 예를 들어 3월에 사망한 경우 9월 30일까지 신고해야 합니다. 피상속인 또는 상속인이 외국에 거주하는 경우에는 9개월로 연장됩니다. 기한 내 신고 시 산출세액의 3% 신고세액공제를 받을 수 있습니다." }
      },
      {
        "@type": "Question",
        "name": "상속 부동산은 어떻게 평가하나요?",
        "acceptedAnswer": { "@type": "Answer", "text": "상속 부동산은 원칙적으로 시가(시장가격)로 평가합니다. 시가를 알 수 없는 경우 공동주택은 공시가격, 단독주택은 개별주택가격, 토지는 개별공시지가를 기준으로 평가합니다. 아파트의 경우 상속개시일 전후 6개월 이내의 매매사례가액이 있으면 이를 시가로 인정합니다. 감정평가를 받으면 시가로 인정되어 정확한 평가가 가능합니다." }
      }
    ]
  }
  </script>
</CalcLayout>

<script>
  // Utility functions
  function formatNumber(num: number): string {
    return num.toLocaleString('ko-KR')
  }

  function formatManWon(num: number): string {
    const man = Math.floor(num / 10000)
    return man > 0 ? `${formatNumber(man)}만원` : '0원'
  }

  function setupNumberInput(id: string) {
    const el = document.getElementById(id) as HTMLInputElement
    if (!el) return

    el.addEventListener('input', (e) => {
      const target = e.target as HTMLInputElement
      const value = target.value.replace(/[^0-9]/g, '')
      const num = parseInt(value) || 0
      target.value = num > 0 ? formatNumber(num) : ''
    })
  }

  function getVal(id: string): number {
    const el = document.getElementById(id) as HTMLInputElement
    if (!el) return 0
    const value = el.value.replace(/[^0-9]/g, '')
    return parseInt(value) || 0
  }

  // Tax brackets
  const taxBrackets = [
    { min: 0, max: 100000000, rate: 0.10, deduction: 0 },
    { min: 100000000, max: 500000000, rate: 0.20, deduction: 10000000 },
    { min: 500000000, max: 1000000000, rate: 0.30, deduction: 60000000 },
    { min: 1000000000, max: 3000000000, rate: 0.40, deduction: 160000000 },
    { min: 3000000000, max: Infinity, rate: 0.50, deduction: 460000000 }
  ]

  function calculateTax(taxBase: number): { tax: number; rate: number } {
    if (taxBase <= 0) return { tax: 0, rate: 0 }

    for (const bracket of taxBrackets) {
      if (taxBase >= bracket.min && taxBase <= bracket.max) {
        const tax = taxBase * bracket.rate - bracket.deduction
        return { tax, rate: bracket.rate }
      }
    }

    return { tax: 0, rate: 0 }
  }

  // Show/hide spouse share input
  const hasSpouseSelect = document.getElementById('hasSpouse') as HTMLSelectElement
  const spouseShareDiv = document.getElementById('spouseShareDiv') as HTMLDivElement

  hasSpouseSelect?.addEventListener('change', () => {
    if (hasSpouseSelect.value === 'yes') {
      spouseShareDiv.style.display = 'block'
    } else {
      spouseShareDiv.style.display = 'none'
    }
  })

  // Show/hide co-residence value input
  const coResidenceCheck = document.getElementById('coResidence') as HTMLInputElement
  const coResidenceValueDiv = document.getElementById('coResidenceValueDiv') as HTMLDivElement

  coResidenceCheck?.addEventListener('change', () => {
    if (coResidenceCheck.checked) {
      coResidenceValueDiv.style.display = 'block'
    } else {
      coResidenceValueDiv.style.display = 'none'
    }
  })

  // Setup number inputs
  setupNumberInput('totalAsset')
  setupNumberInput('debts')
  setupNumberInput('funeralCost')
  setupNumberInput('financialAssets')
  setupNumberInput('coResidenceValue')

  // Calculate
  const form = document.getElementById('calcForm') as HTMLFormElement
  form?.addEventListener('submit', (e) => {
    e.preventDefault()

    // Get input values
    const totalAsset = getVal('totalAsset')
    const debts = getVal('debts')
    const funeralCost = Math.min(getVal('funeralCost'), 15000000) // Max 15M
    const hasSpouse = (document.getElementById('hasSpouse') as HTMLSelectElement).value === 'yes'
    const spouseSharePct = hasSpouse ? parseFloat((document.getElementById('spouseSharePct') as HTMLInputElement).value) || 50 : 0
    const financialAssets = getVal('financialAssets')
    const coResidence = (document.getElementById('coResidence') as HTMLInputElement).checked
    const coResidenceValue = coResidence ? getVal('coResidenceValue') : 0

    // 1. Calculate taxable inheritance
    const taxableInheritance = totalAsset - debts - funeralCost

    // 2. Lump sum deduction (일괄공제 5억)
    const lumpSumDeduction = 500000000

    // 3. Spouse deduction
    let spouseDeduction = 0
    if (hasSpouse) {
      const legalShare = taxableInheritance * (spouseSharePct / 100)
      spouseDeduction = Math.max(500000000, Math.min(3000000000, legalShare))
    }

    // 4. Financial asset deduction
    let financialDeduction = 0
    if (financialAssets > 0) {
      if (financialAssets <= 20000000) {
        financialDeduction = financialAssets
      } else if (financialAssets <= 100000000) {
        financialDeduction = 20000000
      } else if (financialAssets <= 1000000000) {
        financialDeduction = financialAssets * 0.2
      } else {
        financialDeduction = 200000000
      }
    }

    // 5. Co-residence deduction (max 6억)
    const coResidenceDeduction = coResidence ? Math.min(coResidenceValue, 600000000) : 0

    // 6. Calculate tax base
    const taxBase = Math.max(0, taxableInheritance - lumpSumDeduction - spouseDeduction - financialDeduction - coResidenceDeduction)

    // 7. Calculate tax
    const { tax, rate } = calculateTax(taxBase)

    // 8. Filing credit (3%)
    const filingCredit = tax * 0.03

    // 9. Final tax
    const finalTax = Math.max(0, tax - filingCredit)

    // 10. Effective rate
    const effectiveRate = totalAsset > 0 ? (finalTax / totalAsset) * 100 : 0

    // Display results
    document.getElementById('totalTax')!.textContent = formatNumber(Math.round(finalTax)) + '원'
    document.getElementById('effectiveRate')!.textContent = effectiveRate.toFixed(2) + '%'

    document.getElementById('totalAssetDisplay')!.textContent = formatNumber(totalAsset) + '원'
    document.getElementById('debtsFuneralDisplay')!.textContent = formatNumber(debts + funeralCost) + '원'
    document.getElementById('taxableInheritance')!.textContent = formatNumber(taxableInheritance) + '원'
    document.getElementById('lumpSumDeduction')!.textContent = formatNumber(lumpSumDeduction) + '원'
    document.getElementById('taxBase')!.textContent = formatNumber(taxBase) + '원'

    // Show/hide spouse deduction
    const spouseDeductionDiv = document.getElementById('spouseDeductionDiv') as HTMLDivElement
    if (spouseDeduction > 0) {
      spouseDeductionDiv.style.display = 'flex'
      document.getElementById('spouseDeduction')!.textContent = formatNumber(Math.round(spouseDeduction)) + '원'
    } else {
      spouseDeductionDiv.style.display = 'none'
    }

    // Show/hide financial deduction
    const financialDeductionDiv = document.getElementById('financialDeductionDiv') as HTMLDivElement
    if (financialDeduction > 0) {
      financialDeductionDiv.style.display = 'flex'
      document.getElementById('financialDeduction')!.textContent = formatNumber(Math.round(financialDeduction)) + '원'
    } else {
      financialDeductionDiv.style.display = 'none'
    }

    // Show/hide co-residence deduction
    const coResidenceDeductionDiv = document.getElementById('coResidenceDeductionDiv') as HTMLDivElement
    if (coResidenceDeduction > 0) {
      coResidenceDeductionDiv.style.display = 'flex'
      document.getElementById('coResidenceDeduction')!.textContent = formatNumber(coResidenceDeduction) + '원'
    } else {
      coResidenceDeductionDiv.style.display = 'none'
    }

    document.getElementById('taxRateDisplay')!.textContent = (rate * 100).toFixed(0) + '%'
    document.getElementById('calculatedTax')!.textContent = formatNumber(Math.round(tax)) + '원'
    document.getElementById('filingCredit')!.textContent = formatNumber(Math.round(filingCredit)) + '원'
    document.getElementById('finalTax')!.textContent = formatNumber(Math.round(finalTax)) + '원'

    // Show results
    document.getElementById('results')!.classList.remove('hidden')

    // Scroll to results
    document.getElementById('results')!.scrollIntoView({ behavior: 'smooth', block: 'nearest' })
  })
</script>
