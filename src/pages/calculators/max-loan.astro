---
import CalcLayout from '../../layouts/CalcLayout.astro'
---

<CalcLayout title="부동산 최대대출한도 계산기 - 부동산 트렌드 리뷰" description="LTV와 DSR을 기반으로 최대 대출 가능액을 계산하세요.">
    <div class="mb-6">
      <a href="/calculators" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">&larr; 계산기 목록</a>
    </div>
    <h1 class="text-2xl font-bold mb-2 dark:text-white">부동산 최대대출한도 계산기</h1>
    <p class="text-gray-600 dark:text-gray-400 mb-6 text-sm">부동산 최대대출한도 계산기는 LTV와 DSR 규제를 동시에 반영하여 실제 대출 가능 금액을 산출합니다. 소득, 기존 대출, 담보가치를 입력하면 부동산 최대대출한도를 자동으로 계산할 수 있습니다. 주택 구입 자금 마련 전 이 계산기로 부동산 최대대출한도를 정확히 파악해 보세요.</p>

    <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 mb-6">
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">주택가격</label>
          <div class="relative">
            <input type="text" id="propertyPrice" placeholder="500,000,000"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">연소득</label>
          <div class="relative">
            <input type="text" id="annualIncome" placeholder="50,000,000"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">원</span>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">차주유형</label>
          <select id="borrowerType" class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            <option value="생애최초">생애최초</option>
            <option value="무주택자">무주택자</option>
            <option value="1주택자">1주택자</option>
            <option value="다주택자">다주택자</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">지역</label>
          <select id="region" class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white">
            <option value="투기지역">투기과열지구</option>
            <option value="조정지역">조정대상지역</option>
            <option value="수도권">수도권(기타)</option>
            <option value="비수도권">비수도권</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">대출금리</label>
          <div class="relative">
            <input type="text" id="interestRate" placeholder="3.5"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">%</span>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-1 dark:text-gray-200">대출기간</label>
          <div class="relative">
            <input type="number" id="loanTermYears" placeholder="30" min="1" max="50"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8" />
            <span class="absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm">년</span>
          </div>
        </div>

        <button id="calcBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2.5 px-4 rounded-lg transition-colors">
          계산하기
        </button>
      </div>
    </div>

    <div id="error" class="hidden bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 p-3 rounded-lg mb-6">
      <p class="text-red-700 dark:text-red-400 text-sm" id="errorText"></p>
    </div>

    <div id="results" class="hidden space-y-4">
      <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-800 p-4">
        <h2 class="text-sm font-medium text-blue-800 dark:text-blue-300 mb-3">최대 대출 가능액</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">최대 대출액</span><span class="font-bold text-xl text-blue-700 dark:text-blue-300" id="maxLoanAmount"></span></div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4">
        <h2 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">LTV 한도</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">LTV 비율</span><span class="dark:text-gray-200" id="ltvRate"></span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">LTV 기준 한도</span><span class="dark:text-gray-200" id="ltvLimit"></span></div>
        </div>
      </div>
      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4">
        <h2 class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">DSR 한도</h2>
        <div class="space-y-2">
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">DSR 비율</span><span class="dark:text-gray-200" id="dsrRate"></span></div>
          <div class="flex justify-between"><span class="text-sm dark:text-gray-300">DSR 기준 한도</span><span class="dark:text-gray-200" id="dsrLimit"></span></div>
        </div>
      </div>
    </div>

    <div class="mt-6 rounded-lg border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 p-4 space-y-4">
      <div class="flex items-center gap-2 text-blue-600 dark:text-blue-400">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
        <h3 class="text-sm font-semibold">참고 정보</h3>
      </div>
      <p class="text-sm text-gray-600 dark:text-gray-400 leading-relaxed">지역별 LTV(Loan to Value: 담보인정비율)를 기준으로 담보가능금액을 계산해드립니다.</p>
      <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1 list-disc list-inside">
        <li>실제 대출에선 DTI, DSR, 개별 여신 상품별 한도 등이 추가로 적용되어 대출금액이 더 작아질 수도 있습니다.</li>
      </ul>
      <div class="mt-4 overflow-x-auto">
        <table class="w-full text-xs border-collapse">
          <caption class="text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 text-left">2026년 최신 지역별 LTV 기준</caption>
          <thead>
            <tr class="bg-gray-50 dark:bg-gray-700">
              <th class="border border-gray-300 dark:border-gray-600 px-2 py-1.5 text-left">구분</th>
              <th class="border border-gray-300 dark:border-gray-600 px-2 py-1.5 text-left">규제지역 및 조정대상지역</th>
              <th class="border border-gray-300 dark:border-gray-600 px-2 py-1.5 text-left">기타 지역</th>
            </tr>
          </thead>
          <tbody class="text-gray-700 dark:text-gray-300">
            <tr><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">다주택자</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">0%</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">60% (수도권 0%)</td></tr>
            <tr><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">무주택(1주택 처분조건)</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">50%</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">70%</td></tr>
            <tr><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">서민·실수요자</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">70%</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">70%</td></tr>
            <tr><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">생애최초 구매자</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">70%</td><td class="border border-gray-300 dark:border-gray-600 px-2 py-1.5">80% (수도권 70%)</td></tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-8 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700">
      <p class="text-xs text-gray-500 dark:text-gray-400">
        ※ 본 계산기는 참고용이며, 실제 대출 조건은 금융기관에 확인하시기 바랍니다.<br>
        ※ 최대 대출액은 LTV 한도와 DSR 한도 중 낮은 금액으로 결정됩니다.
      </p>
    </div>

    <!-- SEO 콘텐츠 섹션 -->
    <article class="mt-12 prose prose-sm dark:prose-invert max-w-none">
      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">최대대출한도 계산이란?</h2>
        <p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-3">최대 대출 가능액은 담보가치 기준(LTV 한도)과 소득 기준(DSR 한도) 두 가지를 동시에 산출한 뒤, 둘 중 작은 금액으로 결정됩니다. LTV는 담보 부동산의 시가 대비 대출 가능 비율이며, DSR은 연소득 대비 연간 모든 대출 원리금 상환액의 비율입니다.</p>
        <p class="text-gray-700 dark:text-gray-300 leading-relaxed">예를 들어 담보가치 기준으로 5억원까지 대출이 가능하더라도, 소득 기준(DSR)으로 3억원까지만 가능하다면 최종 대출한도는 3억원이 됩니다. 따라서 최대 대출액을 정확히 파악하려면 담보 부동산의 가치뿐만 아니라 본인의 소득 수준과 기존 대출 현황까지 종합적으로 고려해야 합니다.</p>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">대출한도 결정 요소표</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-sm border-collapse border border-gray-200 dark:border-gray-700">
            <thead>
              <tr class="bg-gray-100 dark:bg-gray-700">
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">구분</th>
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">기준</th>
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">산출 방식</th>
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">주요 변수</th>
              </tr>
            </thead>
            <tbody class="dark:text-gray-300">
              <tr>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2 font-medium">LTV 한도</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">담보가치 기준</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">담보가치 x LTV 비율</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">지역, 주택 수, 생애최초 여부</td>
              </tr>
              <tr class="bg-gray-50 dark:bg-gray-800/50">
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2 font-medium">DSR 한도</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">소득 기준</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">연소득 x DSR 비율에서 역산</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">연소득, 기존대출, 금리, 기간</td>
              </tr>
              <tr>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2 font-medium">최종 한도</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">둘 중 작은 금액</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">MIN(LTV 한도, DSR 한도)</td>
                <td class="border border-gray-200 dark:border-gray-600 px-3 py-2">모든 변수 종합 반영</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">최대대출한도 계산 예시</h2>
        <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
          <h3 class="text-base font-semibold dark:text-white mb-3">예시: 비규제지역 무주택 직장인 C씨의 최대 대출한도</h3>
          <div class="text-sm text-gray-700 dark:text-gray-300 space-y-1.5">
            <p>· 아파트 시가: 8억원</p>
            <p>· 적용 LTV: 50% → LTV 기준 한도: 4억원</p>
            <p>· 연소득: 6,000만원</p>
            <p>· DSR 40% 기준 역산 → DSR 기준 한도: 약 3.5억원</p>
            <p class="font-semibold dark:text-white mt-3 pt-3 border-t border-gray-200 dark:border-gray-600">· 최종 대출한도: <span class="text-blue-600 dark:text-blue-400">3.5억원 (DSR 한도가 LTV 한도보다 낮으므로)</span></p>
          </div>
        </div>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">최대대출한도 자주 묻는 질문</h2>
        <div class="space-y-4">
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg" open>
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 대출한도는 어떤 방식으로 결정되나요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">대출한도는 담보가치 기준(LTV)과 소득 기준(DSR) 두 가지 한도를 각각 산출한 뒤, 둘 중 작은 금액으로 결정됩니다. LTV 한도는 담보 부동산의 가치에 지역·주택수별 LTV 비율을 곱해 산출하고, DSR 한도는 연소득에서 DSR 비율 내에서 상환 가능한 대출 원금을 역산하여 산출합니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. LTV와 DSR 중 어떤 것이 우선 적용되나요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">LTV와 DSR은 우선순위 없이 동시에 적용되며, 최종 대출한도는 두 기준 중 낮은 금액입니다. 담보가치가 높아 LTV 한도는 충분하더라도 소득이 낮으면 DSR 한도가 최종 한도가 됩니다. 반대로 소득이 높아도 담보가치가 낮으면 LTV가 한도를 결정합니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 소득 증빙은 어떻게 하나요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">근로소득자는 근로소득 원천징수영수증, 소득금액증명원, 건강보험자격득실확인서 등으로 소득을 증빙합니다. 사업소득자는 종합소득세 신고서, 소득금액증명원, 사업자등록증을 제출합니다. 부부 공동명의 대출 시 배우자 소득을 합산하여 DSR을 계산할 수 있으며, 이 경우 대출한도가 늘어날 수 있습니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 대출한도를 늘리는 방법은 무엇인가요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">대출한도를 늘리려면 DSR을 낮추는 것이 핵심입니다. 기존 대출(신용대출, 카드론 등)을 상환하면 DSR이 낮아져 한도가 늘어납니다. 대출 기간을 30년 이상으로 늘려 월 상환액을 줄이거나, 배우자 소득을 합산하는 방법도 효과적입니다. 또한 고정금리 상품을 선택하면 스트레스 금리 가산이 줄어들어 유리합니다.</div>
          </details>
        </div>
      </section>
    </article>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "대출한도는 어떤 방식으로 결정되나요?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "대출한도는 담보가치 기준(LTV)과 소득 기준(DSR) 두 가지 한도를 각각 산출한 뒤, 둘 중 작은 금액으로 결정됩니다. LTV 한도는 담보 부동산의 가치에 지역·주택수별 LTV 비율을 곱해 산출하고, DSR 한도는 연소득에서 DSR 비율 내에서 상환 가능한 대출 원금을 역산하여 산출합니다."
          }
        },
        {
          "@type": "Question",
          "name": "LTV와 DSR 중 어떤 것이 우선 적용되나요?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "LTV와 DSR은 우선순위 없이 동시에 적용되며, 최종 대출한도는 두 기준 중 낮은 금액입니다. 담보가치가 높아 LTV 한도는 충분하더라도 소득이 낮으면 DSR 한도가 최종 한도가 됩니다. 반대로 소득이 높아도 담보가치가 낮으면 LTV가 한도를 결정합니다."
          }
        },
        {
          "@type": "Question",
          "name": "소득 증빙은 어떻게 하나요?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "근로소득자는 근로소득 원천징수영수증, 소득금액증명원, 건강보험자격득실확인서 등으로 소득을 증빙합니다. 사업소득자는 종합소득세 신고서, 소득금액증명원, 사업자등록증을 제출합니다. 부부 공동명의 대출 시 배우자 소득을 합산하여 DSR을 계산할 수 있으며, 이 경우 대출한도가 늘어날 수 있습니다."
          }
        },
        {
          "@type": "Question",
          "name": "대출한도를 늘리는 방법은 무엇인가요?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "대출한도를 늘리려면 DSR을 낮추는 것이 핵심입니다. 기존 대출(신용대출, 카드론 등)을 상환하면 DSR이 낮아져 한도가 늘어납니다. 대출 기간을 30년 이상으로 늘려 월 상환액을 줄이거나, 배우자 소득을 합산하는 방법도 효과적입니다. 또한 고정금리 상품을 선택하면 스트레스 금리 가산이 줄어들어 유리합니다."
          }
        }
      ]
    }
    </script>
</CalcLayout>

<script>
  function formatNumber(num) {
    return Math.round(num).toLocaleString('ko-KR')
  }

  function formatManWon(amount) {
    const abs = Math.abs(Math.round(amount))
    const sign = amount < 0 ? '-' : ''
    const eok = Math.floor(abs / 100000000)
    const man = Math.floor((abs % 100000000) / 10000)
    const rem = abs % 10000
    let r = sign
    if (eok > 0) {
      r += formatNumber(eok) + '억'
      if (man > 0) r += ' ' + formatNumber(man) + '만'
      if (rem > 0) r += ' ' + formatNumber(rem)
      r += '원'
    } else if (man > 0) {
      r += formatNumber(man) + '만'
      if (rem > 0) r += ' ' + formatNumber(rem)
      r += '원'
    } else {
      r += formatNumber(abs) + '원'
    }
    return r
  }

  function setupNumberInput(el) {
    el.addEventListener('input', function() {
      const raw = this.value.replace(/[^0-9]/g, '')
      if (raw) { this.value = parseInt(raw).toLocaleString('ko-KR') }
      else { this.value = '' }
    })
  }

  function setupDecimalInput(el) {
    el.addEventListener('input', function() {
      let raw = this.value.replace(/[^0-9.]/g, '')
      const parts = raw.split('.')
      if (parts.length > 2) {
        raw = parts[0] + '.' + parts.slice(1).join('')
      }
      this.value = raw
    })
  }

  setupNumberInput(document.getElementById('propertyPrice'))
  setupNumberInput(document.getElementById('annualIncome'))
  setupDecimalInput(document.getElementById('interestRate'))

  const LTV_RATES = {
    '생애최초': {
      '투기지역': 0.7,
      '조정지역': 0.7,
      '수도권': 0.7,
      '비수도권': 0.8,
    },
    '무주택자': {
      '투기지역': 0.4,
      '조정지역': 0.5,
      '수도권': 0.7,
      '비수도권': 0.7,
    },
    '1주택자': {
      '투기지역': 0.4,
      '조정지역': 0.5,
      '수도권': 0.6,
      '비수도권': 0.6,
    },
    '다주택자': {
      '투기지역': 0,
      '조정지역': 0,
      '수도권': 0,
      '비수도권': 0.6,
    },
  }

  const DSR_RATE = 0.4

  function calculateMaxLoan(input) {
    const ltvRate = LTV_RATES[input.borrowerType][input.region]
    const ltvLimit = Math.round(input.propertyPrice * ltvRate)

    const maxAnnualPayment = input.annualIncome * DSR_RATE
    const annualInterestRate = input.interestRate / 100
    const totalPeriods = input.loanTermYears

    const dsrLimit = Math.round(
      maxAnnualPayment / (annualInterestRate + 1 / totalPeriods)
    )

    const maxLoanAmount = Math.min(ltvLimit, dsrLimit)

    return {
      ltvLimit,
      ltvRate: ltvRate * 100,
      dsrLimit,
      dsrRate: DSR_RATE * 100,
      maxLoanAmount,
    }
  }

  document.getElementById('calcBtn').addEventListener('click', () => {
    const errorEl = document.getElementById('error')
    const resultsEl = document.getElementById('results')
    errorEl.classList.add('hidden')
    resultsEl.classList.add('hidden')

    const propertyPrice = parseInt(document.getElementById('propertyPrice').value.replace(/,/g, '')) || 0
    const annualIncome = parseInt(document.getElementById('annualIncome').value.replace(/,/g, '')) || 0
    const borrowerType = document.getElementById('borrowerType').value
    const region = document.getElementById('region').value
    const interestRate = parseFloat(document.getElementById('interestRate').value) || 0
    const loanTermYears = parseInt(document.getElementById('loanTermYears').value) || 0

    if (propertyPrice <= 0 || annualIncome <= 0 || interestRate <= 0 || loanTermYears <= 0) {
      document.getElementById('errorText').textContent = '모든 항목을 올바르게 입력해주세요.'
      errorEl.classList.remove('hidden')
      return
    }

    const result = calculateMaxLoan({
      propertyPrice,
      annualIncome,
      borrowerType,
      region,
      interestRate,
      loanTermYears,
    })

    document.getElementById('maxLoanAmount').textContent = formatManWon(result.maxLoanAmount)
    document.getElementById('ltvRate').textContent = result.ltvRate.toFixed(0) + '%'
    document.getElementById('ltvLimit').textContent = formatManWon(result.ltvLimit)
    document.getElementById('dsrRate').textContent = result.dsrRate.toFixed(0) + '%'
    document.getElementById('dsrLimit').textContent = formatManWon(result.dsrLimit)

    resultsEl.classList.remove('hidden')
  })
</script>
