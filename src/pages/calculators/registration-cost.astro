---
import CalcLayout from '../../layouts/CalcLayout.astro'
---

<CalcLayout
  title="부동산 등기비용 계산기 - 부동산 트렌드 리뷰"
  description="부동산 등기비용을 간편하게 계산하세요. 국민주택채권, 인지세, 법무사 보수까지 한번에 확인."
>
  <div class="py-6 px-4 sm:px-6 lg:px-8">
    <div class="max-w-xl mx-auto">
      <a href="/calculators" class="text-sm text-blue-600 dark:text-blue-400 hover:underline">&larr; 계산기 목록</a>
      <h1 class="text-2xl font-bold mb-2 dark:text-white">부동산 등기비용 계산기</h1>
      <p class="text-gray-600 dark:text-gray-400 mb-6 text-sm">
        부동산 등기비용 계산기를 활용하면 소유권 이전 등기에 필요한 총비용을 한번에 확인할 수 있습니다. 취득세, 국민주택채권, 인지세, 법무사 보수 등 부동산 등기비용 항목별 금액을 자동으로 산출합니다. 매매 계약 전 이 계산기로 부동산 등기비용 총액을 미리 파악하고 자금 계획을 세워 보세요.
      </p>

      <!-- Calculator Card -->
      <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-5 mb-6">
        <div class="space-y-4">
          <!-- 매매가격 -->
          <div>
            <label for="purchasePrice" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              매매가격
            </label>
            <div class="relative">
              <input
                type="text"
                id="purchasePrice"
                class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8"
                placeholder="0"
              />
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400">원</span>
            </div>
          </div>

          <!-- 시가표준액 -->
          <div>
            <label for="assessedValue" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              시가표준액
            </label>
            <div class="relative">
              <input
                type="text"
                id="assessedValue"
                class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8"
                placeholder="0"
              />
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400">원</span>
            </div>
            <p class="mt-1 text-xs text-gray-500 dark:text-gray-400">국토교통부 공시가격 기준</p>
          </div>

          <!-- 지역 -->
          <div>
            <label for="region" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              지역
            </label>
            <select
              id="region"
              class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            >
              <option value="seoul">서울특별시</option>
              <option value="metro">광역시/세종시</option>
              <option value="other">기타 지역</option>
            </select>
          </div>

          <!-- 대출금액 -->
          <div>
            <label for="loanAmount" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              대출금액
            </label>
            <div class="relative">
              <input
                type="text"
                id="loanAmount"
                class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8"
                placeholder="0"
              />
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400">원</span>
            </div>
          </div>

          <!-- 채권할인율 -->
          <div>
            <label for="bondDiscount" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
              채권할인율
            </label>
            <div class="relative">
              <input
                type="text"
                id="bondDiscount"
                class="w-full px-3 py-2 border rounded-lg dark:bg-gray-700 dark:border-gray-600 dark:text-white pr-8"
                placeholder="6"
                value="6"
              />
              <span class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400">%</span>
            </div>
          </div>

          <!-- Calculate Button -->
          <button
            id="calcBtn"
            class="w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors"
          >
            계산하기
          </button>
        </div>
      </div>

      <!-- Results -->
      <div id="results" class="space-y-4 hidden">
        <!-- Summary -->
        <div class="bg-blue-50 dark:bg-blue-900/30 rounded-lg border border-blue-200 dark:border-blue-800 p-4">
          <h2 class="text-lg font-bold mb-3 text-blue-900 dark:text-blue-100">등기비용 합계</h2>
          <div class="space-y-1">
            <div class="flex justify-between items-center text-lg font-bold text-blue-900 dark:text-blue-100">
              <span>총 등기비용</span>
              <span id="totalCost">0원</span>
            </div>
            <div class="flex justify-between items-center text-sm text-blue-700 dark:text-blue-300">
              <span>매매가 대비 비율</span>
              <span id="costRate">0%</span>
            </div>
          </div>
        </div>

        <!-- 소유권이전 등기 -->
        <div class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4">
          <h3 class="text-base font-bold text-gray-900 dark:text-white mb-4">소유권이전 등기</h3>
          <div class="space-y-4">
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">국민주택채권 매입액</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="bondAmount">0원</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">채권 할인비용</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="bondDiscountCost">0원</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">인지세</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="stampTax">0원</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">등기신청 수수료</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="regFee">0원</span>
            </div>
            <div class="flex justify-between items-center py-3">
              <span class="text-gray-700 dark:text-gray-300">법무사 보수 (예상)</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="scrivenerFee">0원</span>
            </div>
          </div>
        </div>

        <!-- 근저당 설정 등기 -->
        <div id="mortgageSection" class="bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 p-4 hidden">
          <h3 class="text-base font-bold text-gray-900 dark:text-white mb-4">근저당 설정 등기</h3>
          <div class="space-y-4">
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">등록면허세</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="mortgageRegTax">0원</span>
            </div>
            <div class="flex justify-between items-center py-3 border-b border-gray-200 dark:border-gray-700">
              <span class="text-gray-700 dark:text-gray-300">지방교육세</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="mortgageEduTax">0원</span>
            </div>
            <div class="flex justify-between items-center py-3">
              <span class="text-gray-700 dark:text-gray-300">법무사 보수</span>
              <span class="font-semibold text-gray-900 dark:text-white" id="mortgageScrivenerFee">0원</span>
            </div>
          </div>
        </div>

        <!-- Disclaimer -->
        <div class="mt-8 p-4 bg-gray-50 dark:bg-gray-800/50 rounded-lg border border-gray-200 dark:border-gray-700">
          <p class="text-xs text-gray-500 dark:text-gray-400">
            ※ 본 계산 결과는 참고용이며, 실제 비용은 지역 및 개별 상황에 따라 달라질 수 있습니다.
          </p>
        </div>
      </div>
    </div>
  </div>

    <!-- SEO 콘텐츠 섹션 -->
    <article class="mt-12 prose prose-sm dark:prose-invert max-w-none">
      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">부동산 등기비용이란?</h2>
        <p class="text-gray-700 dark:text-gray-300 leading-relaxed mb-3">부동산 등기비용은 부동산의 소유권이전등기를 진행할 때 발생하는 제반 비용을 말합니다. 매매, 상속, 증여 등 부동산 소유권이 이전되는 경우 반드시 등기를 해야 하며, 이 과정에서 등록면허세, 지방교육세, 취득세, 법무사 보수, 수입인지, 국민주택채권 매입비용 등이 발생합니다.</p>
        <p class="text-gray-700 dark:text-gray-300 leading-relaxed">등기비용은 부동산 거래 시 매수인이 부담하는 것이 일반적이며, 매매가격과 시가표준액(공시가격)에 따라 금액이 달라집니다. 등기를 완료해야 법적으로 소유권을 주장할 수 있으므로, 부동산 거래 시 등기비용을 사전에 정확히 파악하는 것이 중요합니다.</p>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">등기비용 구성항목 및 세율</h2>
        <div class="overflow-x-auto">
          <table class="w-full text-sm border-collapse border border-gray-200 dark:border-gray-700">
            <thead>
              <tr class="bg-gray-100 dark:bg-gray-700">
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">항목</th>
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">세율/기준</th>
                <th class="border border-gray-200 dark:border-gray-600 px-3 py-2 text-left dark:text-white">비고</th>
              </tr>
            </thead>
            <tbody class="dark:text-gray-300">
              <tr><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등록면허세 (매매)</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">2%</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">시가표준액 기준</td></tr>
              <tr class="bg-gray-50 dark:bg-gray-800/50"><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등록면허세 (상속)</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">0.8%</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">시가표준액 기준</td></tr>
              <tr><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등록면허세 (증여)</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1.5%</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">시가표준액 기준</td></tr>
              <tr class="bg-gray-50 dark:bg-gray-800/50"><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">지방교육세</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등록면허세의 20%</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등록면허세에 부가</td></tr>
              <tr><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">수입인지</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">1억 이하 15만원 / 10억 초과 35만원</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">매매가 기준 구간별</td></tr>
              <tr class="bg-gray-50 dark:bg-gray-800/50"><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">국민주택채권</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">시가표준액의 1~5%</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">지역·금액 구간별 상이</td></tr>
              <tr><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">법무사 보수</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">30~80만원</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">매매가 구간별 상이</td></tr>
              <tr class="bg-gray-50 dark:bg-gray-800/50"><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">등기신청 수수료</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">15,000원</td><td class="border border-gray-200 dark:border-gray-600 px-3 py-2">건당 고정</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">등기비용 계산 예시</h2>
        <div class="bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 border border-gray-200 dark:border-gray-700">
          <h3 class="text-base font-semibold dark:text-white mb-3">예시: 매매가 5억원 아파트 소유권이전등기 (서울, 시가표준액 3억5천만원)</h3>
          <div class="text-sm text-gray-700 dark:text-gray-300 space-y-1.5">
            <p>· 국민주택채권 매입액: 3억5천만원 x 3.1% = 10,850,000원</p>
            <p>· 채권 할인비용 (할인율 6%): 10,850,000원 x 6% = 651,000원</p>
            <p>· 수입인지: 150,000원 (1억~10억 구간)</p>
            <p>· 등기신청 수수료: 15,000원</p>
            <p>· 법무사 보수 (예상): 400,000원</p>
            <p class="font-semibold dark:text-white mt-3 pt-3 border-t border-gray-200 dark:border-gray-600">· 등기비용 합계: <span class="text-blue-600 dark:text-blue-400">약 1,216,000원</span></p>
          </div>
        </div>
      </section>

      <section class="mb-10">
        <h2 class="text-xl font-bold dark:text-white border-b border-gray-200 dark:border-gray-700 pb-2 mb-4">부동산 등기비용 자주 묻는 질문</h2>
        <div class="space-y-4">
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg" open>
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 등기비용에는 어떤 항목이 포함되나요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">등기비용은 국민주택채권 할인비용, 수입인지, 등기신청 수수료, 법무사 보수로 구성됩니다. 이와 별도로 취득세(등록면허세+지방교육세)가 부과되며, 이는 등기 전 납부해야 합니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 셀프등기가 가능한가요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">네, 셀프등기는 가능합니다. 법무사를 선임하지 않고 본인이 직접 등기소에 방문하여 등기를 진행할 수 있으며, 이 경우 법무사 보수를 절약할 수 있습니다. 다만, 서류 준비와 절차가 복잡할 수 있으므로 주의가 필요합니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 등록면허세란 무엇인가요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">등록면허세는 부동산 등기 시 납부하는 지방세입니다. 매매의 경우 시가표준액의 2%, 상속은 0.8%, 증여는 1.5%가 부과됩니다. 여기에 등록면허세의 20%에 해당하는 지방교육세가 추가로 부과됩니다.</div>
          </details>
          <details class="group bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg">
            <summary class="flex items-center justify-between cursor-pointer px-4 py-3 font-medium dark:text-white text-sm hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg">
              <span>Q. 등기 시 필요한 서류는 무엇인가요?</span>
              <svg class="w-4 h-4 flex-shrink-0 ml-2 transition-transform group-open:rotate-180" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
            </summary>
            <div class="px-4 pb-3 text-sm text-gray-700 dark:text-gray-300">소유권이전등기에는 매매계약서, 등기권리증(또는 확인서면), 매도인·매수인 인감증명서, 주민등록초본, 취득세 납부 영수증, 국민주택채권 매입 영수증, 위임장(법무사 대행 시) 등이 필요합니다.</div>
          </details>
        </div>
      </section>
    </article>

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        { "@type": "Question", "name": "등기비용에는 어떤 항목이 포함되나요?", "acceptedAnswer": { "@type": "Answer", "text": "등기비용은 국민주택채권 할인비용, 수입인지, 등기신청 수수료, 법무사 보수로 구성됩니다. 이와 별도로 취득세(등록면허세+지방교육세)가 부과되며, 이는 등기 전 납부해야 합니다." } },
        { "@type": "Question", "name": "셀프등기가 가능한가요?", "acceptedAnswer": { "@type": "Answer", "text": "네, 셀프등기는 가능합니다. 법무사를 선임하지 않고 본인이 직접 등기소에 방문하여 등기를 진행할 수 있으며, 이 경우 법무사 보수를 절약할 수 있습니다. 다만, 서류 준비와 절차가 복잡할 수 있으므로 주의가 필요합니다." } },
        { "@type": "Question", "name": "등록면허세란 무엇인가요?", "acceptedAnswer": { "@type": "Answer", "text": "등록면허세는 부동산 등기 시 납부하는 지방세입니다. 매매의 경우 시가표준액의 2%, 상속은 0.8%, 증여는 1.5%가 부과됩니다. 여기에 등록면허세의 20%에 해당하는 지방교육세가 추가로 부과됩니다." } },
        { "@type": "Question", "name": "등기 시 필요한 서류는 무엇인가요?", "acceptedAnswer": { "@type": "Answer", "text": "소유권이전등기에는 매매계약서, 등기권리증(또는 확인서면), 매도인·매수인 인감증명서, 주민등록초본, 취득세 납부 영수증, 국민주택채권 매입 영수증, 위임장(법무사 대행 시) 등이 필요합니다." } }
      ]
    }
    </script>
</CalcLayout>

<script>
  // Utility functions
  function formatNumber(num: number): string {
    return num.toLocaleString('ko-KR')
  }

  function formatManWon(num: number): string {
    const man = Math.floor(num / 10000)
    return man > 0 ? `${formatNumber(man)}만원` : `${formatNumber(num)}원`
  }

  function setupNumberInput(id: string) {
    const input = document.getElementById(id) as HTMLInputElement
    if (!input) return

    input.addEventListener('input', (e) => {
      const target = e.target as HTMLInputElement
      const value = target.value.replace(/[^\d]/g, '')
      const numValue = parseInt(value) || 0
      target.value = formatNumber(numValue)
    })

    input.addEventListener('focus', (e) => {
      const target = e.target as HTMLInputElement
      if (target.value === '0') {
        target.value = ''
      }
    })
  }

  function getVal(id: string): number {
    const input = document.getElementById(id) as HTMLInputElement
    if (!input) return 0
    return parseInt(input.value.replace(/[^\d]/g, '')) || 0
  }

  // Bond rate tables
  const BOND_RATES_SEOUL = [
    { min: 0, max: 20000000, rate: 0 },
    { min: 20000000, max: 50000000, rate: 0.011 },
    { min: 50000000, max: 100000000, rate: 0.016 },
    { min: 100000000, max: 160000000, rate: 0.021 },
    { min: 160000000, max: 260000000, rate: 0.026 },
    { min: 260000000, max: 600000000, rate: 0.031 },
    { min: 600000000, max: Infinity, rate: 0.035 }
  ]

  const BOND_RATES_METRO = [
    { min: 0, max: 20000000, rate: 0 },
    { min: 20000000, max: 50000000, rate: 0.008 },
    { min: 50000000, max: 100000000, rate: 0.011 },
    { min: 100000000, max: 160000000, rate: 0.016 },
    { min: 160000000, max: 260000000, rate: 0.019 },
    { min: 260000000, max: 600000000, rate: 0.021 },
    { min: 600000000, max: Infinity, rate: 0.030 }
  ]

  const BOND_RATES_OTHER = [
    { min: 0, max: 20000000, rate: 0 },
    { min: 20000000, max: 50000000, rate: 0.005 },
    { min: 50000000, max: 100000000, rate: 0.008 },
    { min: 100000000, max: 160000000, rate: 0.011 },
    { min: 160000000, max: 260000000, rate: 0.013 },
    { min: 260000000, max: 600000000, rate: 0.016 },
    { min: 600000000, max: Infinity, rate: 0.022 }
  ]

  const STAMP_TAX = [
    { min: 0, max: 10000000, amount: 0 },
    { min: 10000000, max: 30000000, amount: 20000 },
    { min: 30000000, max: 50000000, amount: 40000 },
    { min: 50000000, max: 100000000, amount: 70000 },
    { min: 100000000, max: 1000000000, amount: 150000 },
    { min: 1000000000, max: Infinity, amount: 350000 }
  ]

  function getBondRate(assessedValue: number, region: string): number {
    let rates = BOND_RATES_OTHER
    if (region === 'seoul') rates = BOND_RATES_SEOUL
    else if (region === 'metro') rates = BOND_RATES_METRO

    for (const bracket of rates) {
      if (assessedValue >= bracket.min && assessedValue < bracket.max) {
        return bracket.rate
      }
    }
    return 0
  }

  function getStampTax(purchasePrice: number): number {
    for (const bracket of STAMP_TAX) {
      if (purchasePrice >= bracket.min && purchasePrice < bracket.max) {
        return bracket.amount
      }
    }
    return 0
  }

  function getScrivenerFee(purchasePrice: number): number {
    if (purchasePrice < 100000000) return 300000
    if (purchasePrice < 500000000) return 400000
    if (purchasePrice < 1000000000) return 600000
    return 800000
  }

  function calculate() {
    const purchasePrice = getVal('purchasePrice')
    const assessedValue = getVal('assessedValue')
    const loanAmount = getVal('loanAmount')
    const bondDiscountRate = parseFloat((document.getElementById('bondDiscount') as HTMLInputElement).value) || 6
    const region = (document.getElementById('region') as HTMLSelectElement).value

    if (purchasePrice === 0 || assessedValue === 0) {
      alert('매매가격과 시가표준액을 입력해주세요.')
      return
    }

    // Calculate ownership transfer costs
    const bondRate = getBondRate(assessedValue, region)
    const bondAmount = Math.round(assessedValue * bondRate)
    const bondDiscountCost = Math.round(bondAmount * (bondDiscountRate / 100))
    const stampTax = getStampTax(purchasePrice)
    const regFee = 15000
    const scrivenerFee = getScrivenerFee(purchasePrice)

    const ownershipCost = bondDiscountCost + stampTax + regFee + scrivenerFee

    // Calculate mortgage costs
    let mortgageCost = 0
    let mortgageRegTax = 0
    let mortgageEduTax = 0
    let mortgageScrivenerFee = 0

    if (loanAmount > 0) {
      mortgageRegTax = Math.round(loanAmount * 0.002)
      mortgageEduTax = Math.round(mortgageRegTax * 0.2)
      mortgageScrivenerFee = 200000
      mortgageCost = mortgageRegTax + mortgageEduTax + mortgageScrivenerFee
    }

    const totalCost = ownershipCost + mortgageCost
    const costRate = ((totalCost / purchasePrice) * 100).toFixed(2)

    // Display results
    document.getElementById('totalCost')!.textContent = formatManWon(totalCost)
    document.getElementById('costRate')!.textContent = `${costRate}%`
    document.getElementById('bondAmount')!.textContent = formatManWon(bondAmount)
    document.getElementById('bondDiscountCost')!.textContent = formatManWon(bondDiscountCost)
    document.getElementById('stampTax')!.textContent = formatManWon(stampTax)
    document.getElementById('regFee')!.textContent = formatManWon(regFee)
    document.getElementById('scrivenerFee')!.textContent = formatManWon(scrivenerFee)

    if (loanAmount > 0) {
      document.getElementById('mortgageRegTax')!.textContent = formatManWon(mortgageRegTax)
      document.getElementById('mortgageEduTax')!.textContent = formatManWon(mortgageEduTax)
      document.getElementById('mortgageScrivenerFee')!.textContent = formatManWon(mortgageScrivenerFee)
      document.getElementById('mortgageSection')!.classList.remove('hidden')
    } else {
      document.getElementById('mortgageSection')!.classList.add('hidden')
    }

    document.getElementById('results')!.classList.remove('hidden')
    document.getElementById('results')!.scrollIntoView({ behavior: 'smooth', block: 'nearest' })
  }

  // Initialize
  setupNumberInput('purchasePrice')
  setupNumberInput('assessedValue')
  setupNumberInput('loanAmount')

  document.getElementById('calcBtn')!.addEventListener('click', calculate)

  // Enter key support
  document.querySelectorAll('input').forEach(input => {
    input.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') calculate()
    })
  })
</script>
